<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academic Portal - Minimal Working</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
        .modal.show { display: flex; align-items: center; justify-content: center; }
        .modal-content { background: white; padding: 20px; border-radius: 8px; max-width: 400px; width: 90%; }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold text-center mb-8">ğŸ“ Academic Portal - Minimal Working</h1>
        
        <!-- Status Display -->
        <div id="status" class="bg-blue-100 p-4 rounded mb-4">
            <h3 class="font-bold">ğŸ” System Status:</h3>
            <div id="statusContent">Loading...</div>
        </div>
        
        <!-- Test Buttons -->
        <div class="bg-white p-6 rounded shadow mb-6">
            <h3 class="text-xl font-bold mb-4">ğŸ§ª Frontend Tests</h3>
            <button onclick="testBasicClick()" class="bg-blue-500 text-white px-4 py-2 rounded mr-2">Test Click</button>
            <button onclick="testConsoleLog()" class="bg-green-500 text-white px-4 py-2 rounded mr-2">Test Console</button>
            <button onclick="testBackendHealth()" class="bg-purple-500 text-white px-4 py-2 rounded mr-2">Test Backend</button>
        </div>
        
        <!-- Registration Form -->
        <div class="bg-white p-6 rounded shadow mb-6">
            <h3 class="text-xl font-bold mb-4">ğŸ“ Registration Test</h3>
            <form onsubmit="handleRegistration(event)" id="registrationForm">
                <div class="mb-4">
                    <input type="text" id="regName" placeholder="Full Name" class="w-full p-2 border rounded" required>
                </div>
                <div class="mb-4">
                    <input type="email" id="regEmail" placeholder="Email" class="w-full p-2 border rounded" required>
                </div>
                <div class="mb-4">
                    <input type="password" id="regPassword" placeholder="Password (6+ chars)" class="w-full p-2 border rounded" required>
                </div>
                <div class="mb-4">
                    <label class="flex items-center">
                        <input type="checkbox" id="regTerms" required>
                        <span class="ml-2">I accept the terms</span>
                    </label>
                </div>
                <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded">Register</button>
            </form>
        </div>
        
        <!-- Login Form -->
        <div class="bg-white p-6 rounded shadow mb-6">
            <h3 class="text-xl font-bold mb-4">ğŸ” Login Test</h3>
            <form onsubmit="handleLogin(event)" id="loginForm">
                <div class="mb-4">
                    <input type="email" id="loginEmail" placeholder="Email" value="demo@student.com" class="w-full p-2 border rounded" required>
                </div>
                <div class="mb-4">
                    <input type="password" id="loginPassword" placeholder="Password" value="demo123" class="w-full p-2 border rounded" required>
                </div>
                <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded">Login</button>
            </form>
        </div>
        
        <!-- Results -->
        <div id="results" class="bg-gray-50 p-4 rounded">
            <h3 class="font-bold mb-2">ğŸ“Š Results:</h3>
            <div id="resultContent">No tests run yet</div>
        </div>
    </div>

    <script>
        // ===== STEP 1: BASIC JAVASCRIPT VERIFICATION =====
        console.log('ğŸš€ MINIMAL FRONTEND SCRIPT LOADED');
        
        // Global variables
        let API_BASE_URL = 'http://localhost:5001';
        
        // ===== STEP 2: DOM READY HANDLER =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('âœ… DOM CONTENT LOADED');
            updateStatus('âœ… JavaScript loaded and DOM ready');
        });
        
        // ===== STEP 3: UTILITY FUNCTIONS =====
        function updateStatus(message) {
            console.log('ğŸ“Š Status update:', message);
            document.getElementById('statusContent').innerHTML = message;
        }
        
        function addResult(message, type = 'info') {
            console.log('ğŸ“ Result:', message);
            const resultContent = document.getElementById('resultContent');
            const timestamp = new Date().toLocaleTimeString();
            resultContent.innerHTML += `<div class="mb-2 p-2 rounded ${type === 'success' ? 'bg-green-100' : type === 'error' ? 'bg-red-100' : 'bg-blue-100'}">[${timestamp}] ${message}</div>`;
        }
        
        // ===== STEP 4: BASIC TEST FUNCTIONS =====
        function testBasicClick() {
            console.log('ğŸ–±ï¸ BASIC CLICK TEST');
            addResult('ğŸ–±ï¸ Basic click handler works!', 'success');
            updateStatus('âœ… Click handlers are working');
        }
        
        function testConsoleLog() {
            console.log('ğŸ“ CONSOLE LOG TEST - This should appear in browser console (F12)');
            addResult('ğŸ“ Console log test - check browser console (F12)', 'info');
            alert('Check browser console (F12) for log messages');
        }
        
        // ===== STEP 5: BACKEND CONNECTION TEST =====
        async function testBackendHealth() {
            console.log('ğŸ¥ TESTING BACKEND HEALTH');
            addResult('ğŸ¥ Testing backend connection...', 'info');
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/health`);
                console.log('ğŸ“¥ Backend response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('ğŸ“„ Backend data:', data);
                
                addResult(`âœ… Backend connected: ${data.message} (Port: ${data.port})`, 'success');
                updateStatus('âœ… Backend connection working');
                
            } catch (error) {
                console.error('ğŸ’¥ Backend connection failed:', error);
                addResult(`âŒ Backend connection failed: ${error.message}`, 'error');
                updateStatus('âŒ Backend connection failed');
            }
        }
        
        // ===== STEP 6: REGISTRATION HANDLER =====
        async function handleRegistration(event) {
            event.preventDefault();
            console.log('ğŸ“ REGISTRATION FORM SUBMITTED');
            
            const name = document.getElementById('regName').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const password = document.getElementById('regPassword').value;
            const termsAccepted = document.getElementById('regTerms').checked;
            
            console.log('ğŸ“‹ Form data:', { name, email, passwordLength: password.length, termsAccepted });
            
            // Basic validation
            if (!name || !email || !password) {
                addResult('âŒ Please fill all fields', 'error');
                return;
            }
            
            if (password.length < 6) {
                addResult('âŒ Password must be at least 6 characters', 'error');
                return;
            }
            
            if (!termsAccepted) {
                addResult('âŒ Please accept the terms', 'error');
                return;
            }
            
            // Show processing
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Registering...';
            submitBtn.disabled = true;
            
            try {
                addResult('ğŸŒ Sending registration request...', 'info');
                
                const response = await fetch(`${API_BASE_URL}/api/auth/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ name, email, password })
                });
                
                console.log('ğŸ“¥ Registration response status:', response.status);
                
                const data = await response.json();
                console.log('ğŸ“„ Registration response data:', data);
                
                if (data.success) {
                    addResult(`âœ… Registration successful: ${data.data.name} (${data.data.email})`, 'success');
                    document.getElementById('registrationForm').reset();
                } else {
                    addResult(`âŒ Registration failed: ${data.message}`, 'error');
                }
                
            } catch (error) {
                console.error('ğŸ’¥ Registration error:', error);
                addResult(`ğŸ’¥ Registration error: ${error.message}`, 'error');
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        }
        
        // ===== STEP 7: LOGIN HANDLER =====
        async function handleLogin(event) {
            event.preventDefault();
            console.log('ğŸ” LOGIN FORM SUBMITTED');
            
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            console.log('ğŸ“§ Login attempt for:', email);
            
            if (!email || !password) {
                addResult('âŒ Please enter email and password', 'error');
                return;
            }
            
            // Show processing
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Logging in...';
            submitBtn.disabled = true;
            
            try {
                addResult('ğŸŒ Sending login request...', 'info');
                
                const response = await fetch(`${API_BASE_URL}/api/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                });
                
                console.log('ğŸ“¥ Login response status:', response.status);
                
                const data = await response.json();
                console.log('ğŸ“„ Login response data:', data);
                
                if (data.success) {
                    addResult(`âœ… Login successful: Welcome ${data.data.user.name}!`, 'success');
                    localStorage.setItem('authToken', data.data.token);
                    localStorage.setItem('currentUser', JSON.stringify(data.data.user));
                } else {
                    addResult(`âŒ Login failed: ${data.message}`, 'error');
                }
                
            } catch (error) {
                console.error('ğŸ’¥ Login error:', error);
                addResult(`ğŸ’¥ Login error: ${error.message}`, 'error');
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        }
        
        // ===== STEP 8: ERROR HANDLING =====
        window.addEventListener('error', function(event) {
            console.error('ğŸ’¥ GLOBAL JAVASCRIPT ERROR:', event.error);
            addResult(`ğŸ’¥ JavaScript Error: ${event.error.message}`, 'error');
            updateStatus('âŒ JavaScript error occurred');
        });
        
        // ===== STEP 9: INITIALIZATION =====
        console.log('ğŸ¯ MINIMAL FRONTEND INITIALIZATION COMPLETE');
    </script>
</body>
</html>